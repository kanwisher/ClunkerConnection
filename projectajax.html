<!DOCTYPE html>
<html>

<head>

    <!-- Odometr includes -->


<!-- Extra styles for this example -->
<link rel="stylesheet" type="text/css" href="theme.css">

    <style>

    select, #searchButton {
        margin: 10px;
    }

    #carMakesDataList {
        display: none;
        
    }

    .odometer {
    font-size: 100px;
    }

    #carModelsDataList {
        display: none;
    }

    #searchButton {
        display: none;
    }

    #yearDataList {
        display: block;
    }

  

    </style>

    <title>JSSample</title>
    
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript" src="textroller.js"></script>

    
</head>


<body>

<div id="roller" class="textroller"></div>
    
  <select id="yearDataList">
    <option value = "" disabled selected>Select Your Year</option>
    </select>


  <select id="carMakesDataList">
    <option value = "" disabled selected>Select Your Make</option>
  </select>


  <select id="carModelsDataList">
    <option value = "" disabled selected>Select Your Model</option>
    </select>

    <input type='text' placeholder="zipcode--">
    <input type='text' placeholder="Selling Price--">







    <button type="button" id="searchButton">Search</button>
    <div id="images"></div>

    
    <script type="text/javascript" src="data.json"></script>
    <script type="text/javascript">

     var elt         = document.getElementById("roller");
  var texts       = ["--clunker-", "connection"]
  elt.textroller  = new TextRoller({
      el: elt,
      values: texts,    // an array of texts.     default : [el.innerHtml]
      align: "middle",    // right, left or middle. default : middle
      delay: 3000,      // in milliseconds,       default : 5000
      loop: false       // at the end, restart.   default : true
  });


    $(function() { //document onready function
  

 


        const myData = JSON.parse(data); //turns data into a JSON object
        let currentMake = "";
        let currentModel = "";
        let currentYear = "";
        

        
        for (var i = 1950; i <= 2017; i++) {
            let makeString = "<option value ='" + i + "'>" + i + "</option>";
            $("#yearDataList").append(makeString);
            
        }

        for (var i = 0; i < myData.length; i++) {
            let makeString = "<option value ='" + i + "'>" + myData[i].title + "</option>";
            $("#carMakesDataList").append(makeString);
        }


        $("#yearDataList").on('change', function(){
            $("#carMakesDataList").css('display', 'block');
            currentYear = $(this).val();
        })



        
    
        $("#carMakesDataList").on('change', function() { //when make option is selected
            $("#carModelsDataList").empty(); //empty model list everytime Make is selected
            $("#carModelsDataList").append("<option value= '' disabled selected>Select Your Model</option>");
            $("#searchButton").css('display', 'none'); //hide search in case it's visible
            indexValue = $(this).val(); //logs index number of object location
            currentMake = myData[indexValue].title;
            for (var i = 0; i < myData[indexValue].models.length; i++) { //creates options
                let makeString = "<option value ='" + myData[indexValue].models[i].title + "'>" + myData[indexValue].models[i].title + "</option>";
                $("#carModelsDataList").append(makeString);

            }
            
            $("#carModelsDataList").css('display', 'block'); //displays next selector area

             })

        

        $("#carModelsDataList").on('change', function() { //when model option is selected
            currentModel = $(this).val();
            $("#searchButton").css('display', 'block'); //displays search button
         });
          
       


        var params = {
            // Request parameters
            "q": "",
            "count": "10",
            "offset": "0",
            "mkt": "en-us",
            "safeSearch": "Moderate",
        };





        $("#searchButton").on('click', function() {

            params.q = currentYear + " " + currentMake + " " + currentModel;
            $.ajax({


                    url: "https://api.cognitive.microsoft.com/bing/v5.0/images/search?" + $.param(params),
                    beforeSend: function(xhrObj) {
                        // Request headers
                        xhrObj.setRequestHeader("Ocp-Apim-Subscription-Key", "981fa9e92c554da89c418b3cf40e7598");
                    },
                    type: "GET",
                    // Request body
                    data: "{body}",
                })
                .done(function(response) {


                    let newDiv = $("<div>");
                    newDiv.html("<img src='" + response.value[0].contentUrl + "' height='200px'</img>");
                    $("#images").html(newDiv);
                })
                .fail(function() {
                    alert("error");
                });
        });

    })
    </script>
</body>

</html>
